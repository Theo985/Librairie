-- X2ZU UI Library - Version Premium
local X2ZU_Lib = {}
X2ZU_Lib.__index = X2ZU_Lib

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

-- Configuration
local player = Players.LocalPlayer

-- Couleurs modernes
X2ZU_Lib.Colors = {
    Background = Color3.fromRGB(15, 15, 15),
    Secondary = Color3.fromRGB(25, 25, 25),
    Accent = Color3.fromRGB(0, 170, 255),
    AccentHover = Color3.fromRGB(0, 140, 225),
    Text = Color3.fromRGB(240, 240, 240),
    TextSecondary = Color3.fromRGB(180, 180, 180),
    Success = Color3.fromRGB(85, 255, 127),
    Error = Color3.fromRGB(255, 85, 85),
    Warning = Color3.fromRGB(255, 170, 0)
}

-- Effets de blur (optionnel)
local function CreateBlurEffect(parent)
    local blur = Instance.new("BlurEffect")
    blur.Size = 0
    blur.Parent = parent
    return blur
end

-- Fonction pour créer des coins arrondis
local function CreateCorner(radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius)
    return corner
end

-- Fonction pour créer des strokes avancés
local function CreateStroke(color, thickness, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color
    stroke.Thickness = thickness
    stroke.Transparency = transparency or 0
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    return stroke
end

-- Gradient moderne
local function CreateGradient(color1, color2, rotation)
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, color1),
        ColorSequenceKeypoint.new(1, color2)
    })
    gradient.Rotation = rotation or 90
    return gradient
end

-- Création de la fenêtre principale avec design premium
function X2ZU_Lib:CreateWindow(name, icon)
    local self = setmetatable({}, X2ZU_Lib)
    
    -- ScreenGui principal
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "X2ZU_Premium_UI"
    self.ScreenGui.Parent = player.PlayerGui
    self.ScreenGui.ResetOnSpawn = false
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    -- Overlay pour effet de fond
    self.Overlay = Instance.new("Frame")
    self.Overlay.Name = "Overlay"
    self.Overlay.Size = UDim2.new(1, 0, 1, 0)
    self.Overlay.Position = UDim2.new(0, 0, 0, 0)
    self.Overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    self.Overlay.BackgroundTransparency = 0.6
    self.Overlay.BorderSizePixel = 0
    self.Overlay.ZIndex = 0
    self.Overlay.Parent = self.ScreenGui

    -- Container principal avec effet de glass
    self.MainFrame = Instance.new("Frame")
    self.MainFrame.Name = "MainFrame"
    self.MainFrame.Size = UDim2.new(0, 550, 0, 600)
    self.MainFrame.Position = UDim2.new(0.5, -275, 0.5, -300)
    self.MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    self.MainFrame.BackgroundColor3 = self.Colors.Background
    self.MainFrame.BackgroundTransparency = 0.1
    self.MainFrame.BorderSizePixel = 0
    self.MainFrame.ZIndex = 2
    self.MainFrame.Parent = self.ScreenGui

    -- Effet de bordure gradient
    local borderStroke = CreateStroke(self.Colors.Accent, 2)
    borderStroke.Parent = self.MainFrame
    CreateCorner(14).Parent = self.MainFrame

    -- Barre de titre premium
    self.TitleBar = Instance.new("Frame")
    self.TitleBar.Name = "TitleBar"
    self.TitleBar.Size = UDim2.new(1, -20, 0, 50)
    self.TitleBar.Position = UDim2.new(0, 10, 0, 10)
    self.TitleBar.BackgroundColor3 = self.Colors.Secondary
    self.TitleBar.BackgroundTransparency = 0.1
    self.TitleBar.BorderSizePixel = 0
    self.TitleBar.ZIndex = 3
    self.TitleBar.Parent = self.MainFrame

    CreateCorner(10).Parent = self.TitleBar
    CreateStroke(Color3.fromRGB(50, 50, 50), 1).Parent = self.TitleBar

    -- Gradient d'accent dans la barre de titre
    local titleAccent = Instance.new("Frame")
    titleAccent.Name = "TitleAccent"
    titleAccent.Size = UDim2.new(1, 0, 0, 3)
    titleAccent.Position = UDim2.new(0, 0, 1, -3)
    titleAccent.BackgroundColor3 = self.Colors.Accent
    titleAccent.BorderSizePixel = 0
    titleAccent.ZIndex = 4
    titleAccent.Parent = self.TitleBar

    CreateCorner(2).Parent = titleAccent

    -- Icône du titre
    if icon then
        self.TitleIcon = Instance.new("ImageLabel")
        self.TitleIcon.Name = "TitleIcon"
        self.TitleIcon.Size = UDim2.new(0, 30, 0, 30)
        self.TitleIcon.Position = UDim2.new(0, 15, 0.5, -15)
        self.TitleIcon.BackgroundTransparency = 1
        self.TitleIcon.Image = icon
        self.TitleIcon.ImageColor3 = self.Colors.Accent
        self.TitleIcon.ZIndex = 4
        self.TitleIcon.Parent = self.TitleBar
    end

    -- Titre avec effet
    self.TitleLabel = Instance.new("TextLabel")
    self.TitleLabel.Name = "TitleLabel"
    self.TitleLabel.Size = UDim2.new(0, 200, 1, 0)
    self.TitleLabel.Position = UDim2.new(0, icon and 55 or 15, 0, 0)
    self.TitleLabel.BackgroundTransparency = 1
    self.TitleLabel.Text = name or "X2ZU Premium UI"
    self.TitleLabel.TextColor3 = self.Colors.Text
    self.TitleLabel.TextSize = 20
    self.TitleLabel.Font = Enum.Font.GothamBold
    self.TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    self.TitleLabel.ZIndex = 4
    self.TitleLabel.Parent = self.TitleBar

    -- Sous-titre
    self.SubtitleLabel = Instance.new("TextLabel")
    self.SubtitleLabel.Name = "SubtitleLabel"
    self.SubtitleLabel.Size = UDim2.new(0, 200, 0, 15)
    self.SubtitleLabel.Position = UDim2.new(0, icon and 55 or 15, 0, 25)
    self.SubtitleLabel.BackgroundTransparency = 1
    self.SubtitleLabel.Text = "Premium Edition"
    self.SubtitleLabel.TextColor3 = self.Colors.Accent
    self.SubtitleLabel.TextSize = 12
    self.SubtitleLabel.Font = Enum.Font.Gotham
    self.SubtitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    self.SubtitleLabel.ZIndex = 4
    self.SubtitleLabel.Parent = self.TitleBar

    -- Boutons de contrôle premium
    self.MinimizeButton = self:CreateControlButton("−", UDim2.new(1, -70, 0.5, -12), self.Colors.Accent)
    self.MinimizeButton.ZIndex = 4
    self.MinimizeButton.Parent = self.TitleBar

    self.CloseButton = self:CreateControlButton("×", UDim2.new(1, -35, 0.5, -12), self.Colors.Error)
    self.CloseButton.ZIndex = 4
    self.CloseButton.Parent = self.TitleBar

    -- Container des onglets avec design moderne
    self.TabsContainer = Instance.new("Frame")
    self.TabsContainer.Name = "TabsContainer"
    self.TabsContainer.Size = UDim2.new(1, -20, 0, 45)
    self.TabsContainer.Position = UDim2.new(0, 10, 0, 70)
    self.TabsContainer.BackgroundTransparency = 1
    self.TabsContainer.ZIndex = 3
    self.TabsContainer.Parent = self.MainFrame

    -- Container du contenu avec effet de carte
    self.ContentContainer = Instance.new("Frame")
    self.ContentContainer.Name = "ContentContainer"
    self.ContentContainer.Size = UDim2.new(1, -20, 1, -135)
    self.ContentContainer.Position = UDim2.new(0, 10, 0, 125)
    self.ContentContainer.BackgroundColor3 = self.Colors.Secondary
    self.ContentContainer.BackgroundTransparency = 0.1
    self.ContentContainer.ClipsDescendants = true
    self.ContentContainer.ZIndex = 2
    self.ContentContainer.Parent = self.MainFrame

    CreateCorner(12).Parent = self.ContentContainer
    CreateStroke(Color3.fromRGB(50, 50, 50), 1).Parent = self.ContentContainer

    -- État
    self.Tabs = {}
    self.CurrentTab = nil
    self.IsMinimized = false

    -- Setup des événements
    self:SetupDrag()
    self:SetupButtons()

    -- Animation d'entrée
    self.MainFrame.Position = UDim2.new(0.5, -275, 0.3, -300)
    self.MainFrame.BackgroundTransparency = 1
    self.Overlay.BackgroundTransparency = 1

    TweenService:Create(self.MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Position = UDim2.new(0.5, -275, 0.5, -300),
        BackgroundTransparency = 0.1
    }):Play()

    TweenService:Create(self.Overlay, TweenInfo.new(0.5), {
        BackgroundTransparency = 0.6
    }):Play()

    return self
end

-- Bouton de contrôle premium
function X2ZU_Lib:CreateControlButton(text, position, color)
    local button = Instance.new("TextButton")
    button.Name = text .. "Button"
    button.Size = UDim2.new(0, 30, 0, 30)
    button.Position = position
    button.BackgroundColor3 = color
    button.BorderSizePixel = 0
    button.Text = text
    button.TextColor3 = self.Colors.Text
    button.TextSize = 16
    button.Font = Enum.Font.GothamBold
    button.AutoButtonColor = false

    CreateCorner(8).Parent = button
    CreateStroke(Color3.fromRGB(255, 255, 255), 1, 0.8).Parent = button

    -- Animations hover avancées
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundTransparency = 0.2,
            Size = UDim2.new(0, 32, 0, 32),
            Position = position - UDim2.new(0, 1, 0, 1)
        }):Play()
    end)

    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundTransparency = 0,
            Size = UDim2.new(0, 30, 0, 30),
            Position = position
        }):Play()
    end)

    button.MouseButton1Down:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.1), {
            BackgroundTransparency = 0.5,
            Size = UDim2.new(0, 28, 0, 28),
            Position = position + UDim2.new(0, 1, 0, 1)
        }):Play()
    end)

    button.MouseButton1Up:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.1), {
            BackgroundTransparency = 0.2,
            Size = UDim2.new(0, 32, 0, 32),
            Position = position - UDim2.new(0, 1, 0, 1)
        }):Play()
    end)

    return button
end

-- Drag system amélioré
function X2ZU_Lib:SetupDrag()
    local dragging = false
    local dragInput, dragStart, startPos

    self.TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = self.MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    self.TitleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            self.MainFrame.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X, 
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
end

-- Boutons de contrôle
function X2ZU_Lib:SetupButtons()
    self.CloseButton.MouseButton1Click:Connect(function()
        -- Animation de fermeture
        TweenService:Create(self.MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Position = UDim2.new(0.5, -275, 0.7, -300),
            BackgroundTransparency = 1
        }):Play()
        
        TweenService:Create(self.Overlay, TweenInfo.new(0.3), {
            BackgroundTransparency = 1
        }):Play()
        
        wait(0.3)
        self.ScreenGui:Destroy()
    end)

    self.MinimizeButton.MouseButton1Click:Connect(function()
        self:ToggleMinimize()
    end)
end

-- Minimiser la fenêtre avec animation
function X2ZU_Lib:ToggleMinimize()
    self.IsMinimized = not self.IsMinimized
    
    if self.IsMinimized then
        TweenService:Create(self.MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
            Size = UDim2.new(0, 550, 0, 70)
        }):Play()
        self.MinimizeButton.Text = "+"
    else
        TweenService:Create(self.MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
            Size = UDim2.new(0, 550, 0, 600)
        }):Play()
        self.MinimizeButton.Text = "−"
    end
end

-- Créer un onglet premium
function X2ZU_Lib:CreateTab(name, icon)
    local tab = {}
    
    -- Bouton de l'onglet avec design moderne
    tab.Button = Instance.new("TextButton")
    tab.Button.Name = name .. "Tab"
    tab.Button.Size = UDim2.new(0, 110, 1, 0)
    tab.Button.Position = UDim2.new(0, (#self.Tabs * 115), 0, 0)
    tab.Button.BackgroundColor3 = self.Colors.Secondary
    tab.Button.BackgroundTransparency = 0.1
    tab.Button.BorderSizePixel = 0
    tab.Button.Text = name
    tab.Button.TextColor3 = self.Colors.TextSecondary
    tab.Button.TextSize = 14
    tab.Button.Font = Enum.Font.Gotham
    tab.Button.AutoButtonColor = false
    tab.Button.ZIndex = 4
    tab.Button.Parent = self.TabsContainer

    CreateCorner(8).Parent = tab.Button
    CreateStroke(Color3.fromRGB(50, 50, 50), 1).Parent = tab.Button

    -- Animation hover pour les onglets
    tab.Button.MouseEnter:Connect(function()
        if self.CurrentTab ~= tab then
            TweenService:Create(tab.Button, TweenInfo.new(0.2), {
                BackgroundColor3 = Color3.fromRGB(35, 35, 35),
                TextColor3 = self.Colors.Text
            }):Play()
        end
    end)

    tab.Button.MouseLeave:Connect(function()
        if self.CurrentTab ~= tab then
            TweenService:Create(tab.Button, TweenInfo.new(0.2), {
                BackgroundColor3 = self.Colors.Secondary,
                TextColor3 = self.Colors.TextSecondary
            }):Play()
        end
    end)

    -- Contenu de l'onglet
    tab.Content = Instance.new("ScrollingFrame")
    tab.Content.Name = name .. "Content"
    tab.Content.Size = UDim2.new(1, 0, 1, 0)
    tab.Content.Position = UDim2.new(0, 0, 0, 0)
    tab.Content.BackgroundTransparency = 1
    tab.Content.BorderSizePixel = 0
    tab.Content.ScrollBarThickness = 4
    tab.Content.ScrollBarImageColor3 = self.Colors.Accent
    tab.Content.ScrollBarImageTransparency = 0.7
    tab.Content.Visible = false
    tab.Content.ZIndex = 2
    tab.Content.Parent = self.ContentContainer

    local uiListLayout = Instance.new("UIListLayout")
    uiListLayout.Padding = UDim.new(0, 12)
    uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    uiListLayout.Parent = tab.Content

    local uiPadding = Instance.new("UIPadding")
    uiPadding.PaddingTop = UDim.new(0, 15)
    uiPadding.PaddingLeft = UDim.new(0, 15)
    uiPadding.PaddingRight = UDim.new(0, 15)
    uiPadding.PaddingBottom = UDim.new(0, 15)
    uiPadding.Parent = tab.Content

    -- Événement de clic
    tab.Button.MouseButton1Click:Connect(function()
        self:SwitchTab(tab)
    end)

    -- Premier onglet actif
    if #self.Tabs == 0 then
        self:SwitchTab(tab)
    end

    table.insert(self.Tabs, tab)
    return tab
end

-- Changer d'onglet avec animation
function X2ZU_Lib:SwitchTab(targetTab)
    for _, tab in pairs(self.Tabs) do
        tab.Content.Visible = false
        if self.CurrentTab ~= tab then
            TweenService:Create(tab.Button, TweenInfo.new(0.3), {
                BackgroundColor3 = self.Colors.Secondary,
                TextColor3 = self.Colors.TextSecondary
            }):Play()
        end
    end
    
    -- Animation du nouvel onglet actif
    TweenService:Create(targetTab.Button, TweenInfo.new(0.3), {
        BackgroundColor3 = self.Colors.Accent,
        TextColor3 = self.Colors.Text
    }):Play()
    
    targetTab.Content.Visible = true
    self.CurrentTab = targetTab
end

-- Section premium
function X2ZU_Lib:CreateSection(tab, name)
    local section = {}
    
    section.Frame = Instance.new("Frame")
    section.Frame.Name = name .. "Section"
    section.Frame.Size = UDim2.new(1, -30, 0, 50)
    section.Frame.BackgroundTransparency = 1
    section.Frame.LayoutOrder = #tab.Content:GetChildren()
    section.Frame.Parent = tab.Content

    section.Label = Instance.new("TextLabel")
    section.Label.Name = "SectionLabel"
    section.Label.Size = UDim2.new(1, 0, 0, 25)
    section.Label.Position = UDim2.new(0, 0, 0, 0)
    section.Label.BackgroundTransparency = 1
    section.Label.Text = name
    section.Label.TextColor3 = self.Colors.Text
    section.Label.TextSize = 18
    section.Label.Font = Enum.Font.GothamBold
    section.Label.TextXAlignment = Enum.TextXAlignment.Left
    section.Label.Parent = section.Frame

    section.Line = Instance.new("Frame")
    section.Line.Name = "SectionLine"
    section.Line.Size = UDim2.new(1, 0, 0, 2)
    section.Line.Position = UDim2.new(0, 0, 0, 30)
    section.Line.BackgroundColor3 = self.Colors.Accent
    section.Line.BorderSizePixel = 0
    section.Line.Parent = section.Frame

    CreateCorner(1).Parent = section.Line

    -- Gradient pour la ligne
    local gradient = CreateGradient(self.Colors.Accent, self.Colors.AccentHover, 0)
    gradient.Parent = section.Line

    return section
end

-- Bouton premium avec effets
function X2ZU_Lib:CreateButton(tab, name, callback)
    local button = Instance.new("TextButton")
    button.Name = name .. "Button"
    button.Size = UDim2.new(1, -30, 0, 45)
    button.BackgroundColor3 = self.Colors.Secondary
    button.BackgroundTransparency = 0.1
    button.BorderSizePixel = 0
    button.Text = name
    button.TextColor3 = self.Colors.Text
    button.TextSize = 14
    button.Font = Enum.Font.Gotham
    button.AutoButtonColor = false
    button.LayoutOrder = #tab.Content:GetChildren()
    button.Parent = tab.Content

    CreateCorner(10).Parent = button
    CreateStroke(Color3.fromRGB(50, 50, 50), 1).Parent = button

    -- Gradient d'accent
    local accent = Instance.new("Frame")
    accent.Name = "ButtonAccent"
    accent.Size = UDim2.new(0, 4, 1, -10)
    accent.Position = UDim2.new(0, 3, 0, 5)
    accent.BackgroundColor3 = self.Colors.Accent
    accent.BorderSizePixel = 0
    accent.Parent = button

    CreateCorner(2).Parent = accent

    -- Animations avancées
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(35, 35, 35),
            Position = button.Position - UDim2.new(0, 2, 0, 0)
        }):Play()
        TweenService:Create(accent, TweenInfo.new(0.2), {
            Size = UDim2.new(0, 6, 1, -10)
        }):Play()
    end)

    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = self.Colors.Secondary,
            Position = button.Position + UDim2.new(0, 2, 0, 0)
        }):Play()
        TweenService:Create(accent, TweenInfo.new(0.2), {
            Size = UDim2.new(0, 4, 1, -10)
        }):Play()
    end)

    button.MouseButton1Click:Connect(function()
        -- Animation de clic
        TweenService:Create(button, TweenInfo.new(0.1), {
            BackgroundColor3 = self.Colors.Accent,
            BackgroundTransparency = 0.3
        }):Play()
        
        TweenService:Create(accent, TweenInfo.new(0.1), {
            BackgroundColor3 = self.Colors.Text
        }):Play()
        
        wait(0.1)
        
        TweenService:Create(button, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(35, 35, 35),
            BackgroundTransparency = 0.1
        }):Play()
        
        TweenService:Create(accent, TweenInfo.new(0.1), {
            BackgroundColor3 = self.Colors.Accent
        }):Play()
        
        if callback then
            callback()
        end
    end)

    return button
end

-- Toggle premium
function X2ZU_Lib:CreateToggle(tab, name, callback)
    local toggle = {}
    
    toggle.Frame = Instance.new("Frame")
    toggle.Frame.Name = name .. "Toggle"
    toggle.Frame.Size = UDim2.new(1, -30, 0, 35)
    toggle.Frame.BackgroundTransparency = 1
    toggle.Frame.LayoutOrder = #tab.Content:GetChildren()
    toggle.Frame.Parent = tab.Content

    toggle.Label = Instance.new("TextLabel")
    toggle.Label.Name = "ToggleLabel"
    toggle.Label.Size = UDim2.new(0.7, 0, 1, 0)
    toggle.Label.Position = UDim2.new(0, 0, 0, 0)
    toggle.Label.BackgroundTransparency = 1
    toggle.Label.Text = name
    toggle.Label.TextColor3 = self.Colors.Text
    toggle.Label.TextSize = 14
    toggle.Label.Font = Enum.Font.Gotham
    toggle.Label.TextXAlignment = Enum.TextXAlignment.Left
    toggle.Label.Parent = toggle.Frame

    toggle.Button = Instance.new("TextButton")
    toggle.Button.Name = "ToggleButton"
    toggle.Button.Size = UDim2.new(0, 55, 0, 28)
    toggle.Button.Position = UDim2.new(1, -55, 0.5, -14)
    toggle.Button.BackgroundColor3 = self.Colors.Secondary
    toggle.Button.BackgroundTransparency = 0.1
    toggle.Button.BorderSizePixel = 0
    toggle.Button.Text = ""
    toggle.Button.AutoButtonColor = false
    toggle.Button.Parent = toggle.Frame

    CreateCorner(14).Parent = toggle.Button
    CreateStroke(Color3.fromRGB(50, 50, 50), 1).Parent = toggle.Button

    toggle.Dot = Instance.new("Frame")
    toggle.Dot.Name = "ToggleDot"
    toggle.Dot.Size = UDim2.new(0, 20, 0, 20)
    toggle.Dot.Position = UDim2.new(0, 4, 0.5, -10)
    toggle.Dot.BackgroundColor3 = self.Colors.Text
    toggle.Dot.BorderSizePixel = 0
    toggle.Dot.Parent = toggle.Button

    CreateCorner(10).Parent = toggle.Dot

    toggle.State = false

    local function updateToggle()
        if toggle.State then
            TweenService:Create(toggle.Button, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                BackgroundColor3 = self.Colors.Success
            }):Play()
            TweenService:Create(toggle.Dot, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                Position = UDim2.new(1, -24, 0.5, -10)
            }):Play()
        else
            TweenService:Create(toggle.Button, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                BackgroundColor3 = self.Colors.Secondary
            }):Play()
            TweenService:Create(toggle.Dot, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                Position = UDim2.new(0, 4, 0.5, -10)
            }):Play()
        end
    end

    toggle.Button.MouseButton1Click:Connect(function()
        toggle.State = not toggle.State
        updateToggle()
        if callback then
            callback(toggle.State)
        end
    end)

    -- Animation hover
    toggle.Button.MouseEnter:Connect(function()
        TweenService:Create(toggle.Button, TweenInfo.new(0.2), {
            BackgroundTransparency = 0
        }):Play()
    end)

    toggle.Button.MouseLeave:Connect(function()
        TweenService:Create(toggle.Button, TweenInfo.new(0.2), {
            BackgroundTransparency = 0.1
        }):Play()
    end)

    return toggle
end

-- Slider premium
function X2ZU_Lib:CreateSlider(tab, name, min, max, callback)
    local slider = {}
    
    slider.Frame = Instance.new("Frame")
    slider.Frame.Name = name .. "Slider"
    slider.Frame.Size = UDim2.new(1, -30, 0, 70)
    slider.Frame.BackgroundTransparency = 1
    slider.Frame.LayoutOrder = #tab.Content:GetChildren()
    slider.Frame.Parent = tab.Content

    slider.Label = Instance.new("TextLabel")
    slider.Label.Name = "SliderLabel"
    slider.Label.Size = UDim2.new(1, 0, 0, 25)
    slider.Label.Position = UDim2.new(0, 0, 0, 0)
    slider.Label.BackgroundTransparency = 1
    slider.Label.Text = name .. ": " .. tostring(min)
    slider.Label.TextColor3 = self.Colors.Text
    slider.Label.TextSize = 14
    slider.Label.Font = Enum.Font.Gotham
    slider.Label.TextXAlignment = Enum.TextXAlignment.Left
    slider.Label.Parent = slider.Frame

    slider.ValueLabel = Instance.new("TextLabel")
    slider.ValueLabel.Name = "ValueLabel"
    slider.ValueLabel.Size = UDim2.new(0, 60, 0, 25)
    slider.ValueLabel.Position = UDim2.new(1, -60, 0, 0)
    slider.ValueLabel.BackgroundTransparency = 1
    slider.ValueLabel.Text = tostring(min)
    slider.ValueLabel.TextColor3 = self.Colors.Accent
    slider.ValueLabel.TextSize = 14
    slider.ValueLabel.Font = Enum.Font.GothamBold
    slider.ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
    slider.ValueLabel.Parent = slider.Frame

    slider.Track = Instance.new("Frame")
    slider.Track.Name = "SliderTrack"
    slider.Track.Size = UDim2.new(1, 0, 0, 6)
    slider.Track.Position = UDim2.new(0, 0, 0, 40)
    slider.Track.BackgroundColor3 = self.Colors.Secondary
    slider.Track.BackgroundTransparency = 0.1
    slider.Track.BorderSizePixel = 0
    slider.Track.Parent = slider.Frame

    CreateCorner(3).Parent = slider.Track
    CreateStroke(Color3.fromRGB(50, 50, 50), 1).Parent = slider.Track

    slider.Fill = Instance.new("Frame")
    slider.Fill.Name = "SliderFill"
    slider.Fill.Size = UDim2.new(0, 0, 1, 0)
    slider.Fill.BackgroundColor3 = self.Colors.Accent
    slider.Fill.BorderSizePixel = 0
    slider.Fill.Parent = slider.Track

    CreateCorner(3).Parent = slider.Fill

    -- Gradient pour le fill
    local fillGradient = CreateGradient(self.Colors.Accent, self.Colors.AccentHover, 0)
    fillGradient.Parent = slider.Fill

    slider.Thumb = Instance.new("TextButton")
    slider.Thumb.Name = "SliderThumb"
    slider.Thumb.Size = UDim2.new(0, 18, 0, 18)
    slider.Thumb.Position = UDim2.new(0, -9, 0.5, -9)
    slider.Thumb.BackgroundColor3 = self.Colors.Text
    slider.Thumb.BorderSizePixel = 0
    slider.Thumb.Text = ""
    slider.Thumb.AutoButtonColor = false
    slider.Thumb.Parent = slider.Track

    CreateCorner(9).Parent = slider.Thumb
    CreateStroke(self.Colors.Accent, 2).Parent = slider.Thumb

    slider.Value = min
    slider.Dragging = false

    local function updateSlider(mouseX)
        local relativeX = math.clamp(mouseX - slider.Track.AbsolutePosition.X, 0, slider.Track.AbsoluteSize.X)
        local percentage = relativeX / slider.Track.AbsoluteSize.X
        slider.Value = math.floor(min + (max - min) * percentage)
        
        slider.Fill.Size = UDim2.new(percentage, 0, 1, 0)
        slider.Thumb.Position = UDim2.new(percentage, -9, 0.5, -9)
        slider.ValueLabel.Text = tostring(slider.Value)
        
        if callback then
            callback(slider.Value)
        end
    end

    slider.Thumb.MouseButton1Down:Connect(function()
        slider.Dragging = true
        TweenService:Create(slider.Thumb, TweenInfo.new(0.1), {
            Size = UDim2.new(0, 22, 0, 22)
        }):Play()
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            slider.Dragging = false
            TweenService:Create(slider.Thumb, TweenInfo.new(0.1), {
                Size = UDim2.new(0, 18, 0, 18)
            }):Play()
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if slider.Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            updateSlider(input.Position.X)
        end
    end)

    slider.Track.MouseButton1Down:Connect(function(x, y)
        updateSlider(x)
    end)

    return slider
end

-- Label premium
function X2ZU_Lib:CreateLabel(tab, text)
    local label = Instance.new("TextLabel")
    label.Name = text .. "Label"
    label.Size = UDim2.new(1, -30, 0, 35)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = self.Colors.Text
    label.TextSize = 16
    label.Font = Enum.Font.GothamBold
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.LayoutOrder = #tab.Content:GetChildren()
    label.Parent = tab.Content

    return label
end

return X2ZU_Lib
